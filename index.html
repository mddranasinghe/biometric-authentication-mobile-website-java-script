<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAuthn Demo</title>
</head>
<body>
    <h1>WebAuthn Demo</h1>

    <h2>Registration</h2>
    <button id="registerButton">Register Credentials</button>

    <h2>Authentication</h2>
    <button id="authenticateButton">Authenticate</button>

    <script>
        // Function to handle registration of WebAuthn credentials
        async function registerCredentials() {
            try {
                // Generate a random challenge
                const challenge = new Uint8Array(32);
                
                // Create PublicKeyCredentialCreationOptions
                const publicKeyCredentialCreationOptions = {
                    challenge: challenge,
                    rp: { name: 'WebAuthn Demo Site' },
                    user: { id: new Uint8Array(16), name: 'user@example.com', displayName: 'User' },
                    pubKeyCredParams: [{ type: 'public-key', alg: -7 }],
                    timeout: 60000
                };

                // Register credentials
                const credential = await navigator.credentials.create({
                    publicKey: publicKeyCredentialCreationOptions
                });

                console.log('Credential registered:', credential);
            } catch (error) {
                console.error('Error during credential registration:', error);
            }
        }

        // Function to handle authentication using WebAuthn credentials
        async function authenticate() {
            try {
                // Generate a random challenge
                const challenge = new Uint8Array(32);

                // Create PublicKeyCredentialRequestOptions
                const publicKeyCredentialRequestOptions = {
                    challenge: challenge,
                    userVerification: 'required'
                };

                // Get credentials for authentication
                const credential = await navigator.credentials.get({
                    publicKey: publicKeyCredentialRequestOptions
                });

                console.log('Credential authenticated:', credential);
            } catch (error) {
                console.error('Error during WebAuthn authentication:', error);
            }
        }

        // Add event listeners to buttons
        document.getElementById('registerButton').addEventListener('click', registerCredentials);
        document.getElementById('authenticateButton').addEventListener('click', authenticate);
    </script>
</body>
</html>
