<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save Username and Password</title>
</head>
<body>
    <h1>Save Username and Password</h1>

    <label for="username">Username:</label>
    <input type="text" id="username" name="username"><br><br>

    <label for="password">Password:</label>
    <input type="password" id="password" name="password"><br><br>

    <button onclick="saveCredentials()">Save Credentials</button>
    <button onclick="displayCredentials()">display Credentials</button>
    <script>
        let db;

        async function initDB() {
            return new Promise((resolve, reject) => {
                const request = window.indexedDB.open('CredentialsDB', 1);

                request.onerror = () => {
                    reject('Error opening IndexedDB');
                };

                request.onsuccess = () => {
                    db = request.result;
                    resolve();
                };

                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    const store = db.createObjectStore('credentials', { keyPath: 'username' });
                    store.createIndex('usernameIndex', 'username', { unique: true });
                };
            });
        }

        async function saveCredentials() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!username || !password) {
                alert('Please enter both username and password.');
                return;
            }

            try {
                await initDB();

                const transaction = db.transaction(['credentials'], 'readwrite');
                const store = transaction.objectStore('credentials');
                const request = store.add({ username: username, password: password });

                request.onerror = (event) => {
                    alert('Error saving credentials: ' + event.target.error.message);
                };

                request.onsuccess = () => {
                    alert('Credentials saved successfully.');
                };
            } catch (error) {
                console.error('Error saving credentials:', error);
            }
        }


        // Function to retrieve and display stored credentials
async function displayCredentials() {
    try{
        await initDB();
    // Open a transaction on the IndexedDB database
    const transaction = db.transaction(['credentials'], 'readonly');
    const store = transaction.objectStore('credentials');

    // Open a cursor to iterate through stored credentials
    const request = store.openCursor();

    request.onerror = (event) => {
        console.error('Error retrieving stored credentials:', event.target.error);
    };

    request.onsuccess = (event) => {
        const cursor = event.target.result;
        if (cursor) {
            // Display each credential
            const credential = cursor.value;
            console.log('Stored Credential:', credential);
            // Display the credential on the webpage, e.g., in a list
            displayCredential(credential);
            // Move to the next credential
            cursor.continue();
        } else {
            console.log('All stored credentials retrieved.');
        }
    };
} catch (error) {
                console.error('Error display credentials:', error);
            }
}

// Function to display a credential on the webpage
function displayCredential(credential) {
    const credentialList = document.getElementById('credentialList');
    const listItem = document.createElement('li');
    listItem.textContent = `Username: ${credential.username}, Password: ${credential.password}`;
    //credentialList.appendChild(listItem);
}



    </script>
</body>
</html>
